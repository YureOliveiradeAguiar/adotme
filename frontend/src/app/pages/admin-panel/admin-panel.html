<div class="admin-container app-container">
    <app-header />
    <main class="admin-content app-content">
        <div class="container">
            <div class="admin-header">
                <h1>Painel Administrativo</h1>
                <p>Gerencie os pets dispon√≠veis para ado√ß√£o</p>
            </div>

            <!-- Bot√£o Adicionar Pet -->
            <div class="admin-actions">
                <button class="btn-primary" (click)="startAddPet()" *ngIf="!showAddForm">
                    + Adicionar Novo Pet
                </button>
            </div>

            <!-- Formul√°rio de Adi√ß√£o/Edi√ß√£o -->
            <div class="pet-form" *ngIf="showAddForm">
                <h2>{{ editingPet ? 'Editar Pet' : 'Adicionar Novo Pet' }}</h2>

                <div class="form-grid">
                    <!-- Nome (Input de texto) -->
                    <div class="form-group">
                        <label>Nome *</label>
                        <input type="text" [(ngModel)]="newPet.name" placeholder="Digite o nome do pet">
                    </div>

                    <!-- Esp√©cie (Bot√µes) -->
                    <div class="form-group">
                        <label>Esp√©cie *</label>
                        <div class="button-group">
                            <button type="button" [class.active]="newPet.species === 'DOG'"
                                (click)="newPet.species = 'DOG'">
                                üêï Cachorro
                            </button>
                            <button type="button" [class.active]="newPet.species === 'CAT'"
                                (click)="newPet.species = 'CAT'">
                                üêà Gato
                            </button>
                        </div>
                    </div>

                    <!-- Ra√ßa (Bot√µes + Input condicional) -->
                    <div class="form-group">
                        <label>Ra√ßa *</label>
                        <div class="button-group">
                            <button type="button" [class.active]="newPet.breed === 'SRD'"
                                (click)="newPet.breed = 'SRD'; customBreed = ''">
                                SRD
                            </button>
                            <button type="button" [class.active]="newPet.breed !== 'SRD'"
                                (click)="newPet.breed = 'OTHER'">
                                Outro
                            </button>
                        </div>
                        <input *ngIf="newPet.breed !== 'SRD'" type="text" [(ngModel)]="customBreed"
                            (input)="newPet.breed = customBreed" placeholder="Digite a ra√ßa">
                    </div>

                    <!-- Idade (Bot√µes) -->
                    <div class="form-group">
                        <label>Idade *</label>
                        <div class="button-group">
                            <button type="button" [class.active]="newPet.ageCategory === 'FILHOTE'"
                                (click)="newPet.ageCategory = 'FILHOTE'">
                                Filhote
                            </button>
                            <button type="button" [class.active]="newPet.ageCategory === 'ADULTO'"
                                (click)="newPet.ageCategory = 'ADULTO'">
                                Adulto
                            </button>
                            <button type="button" [class.active]="newPet.ageCategory === 'IDOSO'"
                                (click)="newPet.ageCategory = 'IDOSO'">
                                Idoso
                            </button>
                        </div>
                    </div>

                    <!-- Porte (Bot√µes) -->
                    <div class="form-group">
                        <label>Porte *</label>
                        <div class="button-group">
                            <button type="button" [class.active]="newPet.size === 'SMALL'"
                                (click)="newPet.size = 'SMALL'">
                                Pequeno
                            </button>
                            <button type="button" [class.active]="newPet.size === 'MEDIUM'"
                                (click)="newPet.size = 'MEDIUM'">
                                M√©dio
                            </button>
                            <button type="button" [class.active]="newPet.size === 'LARGE'"
                                (click)="newPet.size = 'LARGE'">
                                Grande
                            </button>
                        </div>
                    </div>

                    <!-- G√™nero (Bot√µes) -->
                    <div class="form-group">
                        <label>G√™nero *</label>
                        <div class="button-group">
                            <button type="button" [class.active]="newPet.gender === 'MALE'"
                                (click)="newPet.gender = 'MALE'">
                                Macho
                            </button>
                            <button type="button" [class.active]="newPet.gender === 'FEMALE'"
                                (click)="newPet.gender = 'FEMALE'">
                                F√™mea
                            </button>
                        </div>
                    </div>

                    <!-- Sa√∫de (Bot√µes) -->
                    <div class="form-group">
                        <label>Sa√∫de *</label>
                        <div class="button-group health-buttons">
                            <button type="button" [class.active]="newPet.vaccinated"
                                (click)="newPet.vaccinated = !newPet.vaccinated">
                                {{ newPet.vaccinated ? '‚úì' : '' }} Vacinado
                            </button>
                            <button type="button" [class.active]="newPet.neutered"
                                (click)="newPet.neutered = !newPet.neutered">
                                {{ newPet.neutered ? '‚úì' : '' }} Castrado
                            </button>
                        </div>
                    </div>

                    <!-- Descri√ß√£o (Input de texto) -->
                    <div class="form-group full-width">
                        <label>Descri√ß√£o</label>
                        <textarea [(ngModel)]="newPet.description" placeholder="Descreva o pet (opcional)"></textarea>
                        <small>Deixe em branco para usar a descri√ß√£o padr√£o</small>
                    </div>

                    <!-- Upload de Imagens -->
                    <div class="form-group full-width">
                        <label>Imagens (m√°x. 5)</label>
                        <input type="file" (change)="onImageSelected($event)" multiple accept="image/*"
                            class="file-input">

                        <div class="image-preview" *ngIf="selectedImages.length > 0">
                            <div class="preview-item" *ngFor="let image of selectedImages; let i = index">
                                <img [src]="getImageUrl(image)" alt="Preview">
                                <button type="button" class="remove-image" (click)="removeImage(i)">√ó</button>
                            </div>
                        </div>
                    </div>
                </div>

                <!-- Bot√µes do Formul√°rio -->
                <div class="form-actions">
                    <button type="button" class="btn-secondary" (click)="cancelForm()">
                        Cancelar
                    </button>
                    <button type="button" class="btn-primary" (click)="submitPet()">
                        {{ editingPet ? 'Atualizar' : 'Cadastrar' }} Pet
                    </button>
                </div>
            </div>

            <!-- Lista de Pets -->
            <div class="pets-list-section" *ngIf="!showAddForm">
                <!-- Filtros -->
                <div class="admin-filters">
                    <input type="text" [(ngModel)]="filterSearch" (input)="applyFilters()"
                        placeholder="Buscar por nome ou ra√ßa...">

                    <select [(ngModel)]="filterType" (change)="applyFilters()">
                        <option value="">Todos os tipos</option>
                        <option value="DOG">Cachorros</option>
                        <option value="CAT">Gatos</option>
                    </select>

                    <button class="btn-secondary" (click)="clearFilters()">Limpar</button>
                </div>

                <!-- Lista -->
                <div class="pets-grid">
                    <div class="pet-card" *ngFor="let pet of filteredPets">
                        <div class="pet-info">
                            <h3>{{ pet.name }}</h3>
                            <p><strong>Esp√©cie:</strong> {{ pet.species === 'DOG' ? 'Cachorro' : 'Gato' }}</p>
                            <p><strong>Ra√ßa:</strong> {{ pet.breed }}</p>
                            <p><strong>Idade:</strong> {{ pet.ageCategory }}</p>
                            <p><strong>Porte:</strong> {{ pet.size }}</p>
                        </div>
                        <div class="pet-actions">
                            <button class="btn-edit" (click)="startEditPet(pet)">
                                Editar
                            </button>
                            <button class="btn-delete" (click)="deletePet(pet)">
                                Excluir
                            </button>
                        </div>
                    </div>
                </div>

                <p *ngIf="filteredPets.length === 0" class="no-pets">
                    Nenhum pet encontrado.
                </p>
            </div>
        </div>
    </main>
    <app-footer />
</div>